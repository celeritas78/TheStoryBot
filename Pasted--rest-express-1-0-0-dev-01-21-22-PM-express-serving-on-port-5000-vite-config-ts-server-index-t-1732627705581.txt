
> rest-express@1.0.0 dev
01:21:22 PM [express] serving on port 5000 vite.config.ts.* server/index.ts

[TypeScript] Found 0 errors. Watching for file changes.
Fetching favorites...
Favorites fetched: [
  {
    id: 4,
    childName: 'sameer',
    theme: 'adventure',
    createdAt: 2024-11-26T13:15:06.180Z,
    favoriteId: 3,
    firstSegment: {
      id: 4,
      storyId: 4,
      content: '[Story Text]\n' +
        '\n' +
        "Once upon a time, there was a brave little boy named Sameer. Sameer loved going on adventures with his most special friend - Daddy. They weren't alone on their adventures; they were joined by three magical guides from ancient India: Hanuman, Ram, and Sita.\n" +
        '\n' +
        `"One day," began Daddy, "we're going to get back the golden apple stolen by the wicked Raavan."\n` +
        '\n' +
        'Everyone was excited, especially Sameer. He asked Hanuman, as strong as wind, Ram, the noble prince, and Sita, the princess with the brightest heart, to help them on their exciting mission.\n' +
        '\n' +
        `Their journey led them to a vast mountain. Sameer wasn't discouraged but shouted, "Hanuman, could you help us across?"\n` +
        '\n' +
        "With a comforting smile, Hanuman carried everyone across the mountain. On the other side, they found a labyrinth but they weren't afraid. Sameer turned to Ram and Sita, asking for their wisdom. Together, they followed the right path and found the hidden castle.\n" +
        '\n' +
        `Raavan stood guard but he was no match for Sameer’s courage. With Daddy by his side and their magical friends' help, Sameer demanded, "Return the golden apple, Raavan!"\n` +
        '\n' +
        'Raavan, seeing the brave boy, relented, returning the golden apple with an apology.\n' +
        '\n' +
        'Their mission completed, Sameer and Daddy travelled back home – their hearts filled with a story of bravery and friendship. That night, Daddy tucked Sameer in bed, praising, "You were so brave today, Sameer!"\n' +
        '\n' +
        `Beaming, Sameer whispered, "Tomorrow, Daddy, let's plan another adventure!”\n` +
        '\n' +
        '[Scene Description]\n' +
        '\n' +
        "Sameer, his daddy, Hanuman, Ram, and Sita standing triumphantly outside Raavan's castle, holding the golden apple. A proud and happy Sameer, with Daddy beside him, beaming with pride and joy. In the background, Raavan watching them leave, a look of surprise and defeat on his face. The castle and the labyrinth are visible, representing the adventurous journey they undertook.",
      imageUrl: 'https://oaidalleapiprodscus.blob.core.windows.net/private/org-8hqUrMQvREaIO7bDZXZNpDR1/user-RcpYfzRbtZ5ra2JTLyVdShGs/img-bwQXT1tS6YWzIhLYUaNMcM9b.png?st=2024-11-26T12%3A14%3A40Z&se=2024-11-26T14%3A14%3A40Z&sp=r&sv=2024-08-04&sr=b&rscd=inline&rsct=image/png&skoid=d505667d-d6c1-4a0a-bac7-5c84a87759f8&sktid=a48cca56-e6da-484e-a814-9c849652bcb3&skt=2024-11-26T01%3A29%3A21Z&ske=2024-11-27T01%3A29%3A21Z&sks=b&skv=2024-08-04&sig=fEPgHztQhMVhKkuvaYlw2J0iWM0ar3A9hDS2oWuAQo4%3D',
      audioUrl: '/audio/a3183b85-d932-4c49-9357-22170388018d.mp3',
      sequence: 1,
      createdAt: 2024-11-26T13:15:06.430Z
    }
  },
  {
    id: 3,
    childName: 'skye',
    theme: 'nature',
    createdAt: 2024-11-26T12:34:41.533Z,
    favoriteId: 2,
    firstSegment: {
      id: 3,
      storyId: 3,
      content: '[Story Text]\n' +
        '\n' +
        'Once upon a time, there was a little 3-year-old girl called Skye. She lived in a magical world filled with her best friends - a friendly dragon named Drako, a kind princess named Lily, a wise frog named Freddy, and a caring mummy named Mummy Mia. \n' +
        '\n' +
        `Every day, they would embark on exciting adventures. They loved exploring the colourful meadows and the fragrant flower fields. One fine day, spotting a beautiful butterfly fluttering about, Skye exclaimed, "Let's follow the butterfly!" Everyone agreed, and off they went. \n` +
        '\n' +
        'As they chased the butterfly, Skye and her friends learned about the different flowers and trees they passed. The princess taught Skye how to make daisy chains, while the frog showed them how to tell time using a sunflower like a sundial. \n' +
        '\n' +
        'Then, Mummy Mia explained why trees shed their leaves in the autumn, and how every leaf turned into soil over time. Listening to her, Skye hugged a tree lovingly. Drako, using his gentle fire breath, toasted marshmallows they had picked earlier. Sharing laughs and marshmallows, they understood the importance and beauty of nature.\n' +
        '\n' +
        `As they headed home, Skye looked at her friends, the butterfly gently landing on her shoulder and confessed, "This is the best day ever!" And so, the sun slowly set on another magical day in Skye's world, filled with love, adventure, and the beauty of the natural world.`,
      imageUrl: 'https://oaidalleapiprodscus.blob.core.windows.net/private/org-8hqUrMQvREaIO7bDZXZNpDR1/user-RcpYfzRbtZ5ra2JTLyVdShGs/img-Bqj7gCU4ZleJZQwBuqcjJA5y.png?st=2024-11-26T11%3A34%3A30Z&se=2024-11-26T13%3A34%3A30Z&sp=r&sv=2024-08-04&sr=b&rscd=inline&rsct=image/png&skoid=d505667d-d6c1-4a0a-bac7-5c84a87759f8&sktid=a48cca56-e6da-484e-a814-9c849652bcb3&skt=2024-11-25T18%3A55%3A30Z&ske=2024-11-26T18%3A55%3A30Z&sks=b&skv=2024-08-04&sig=TxmLy3VOP%2BPxvxecx11IAQynLvu9nOu0JFKjvq9qIMc%3D',
      audioUrl: '/audio/c7431b1c-c4b3-4b74-a3a9-258b915fe7fd.mp3',
      sequence: 1,
      createdAt: 2024-11-26T12:34:41.771Z
    }
  },
  {
    id: 2,
    childName: 'sam',
    theme: 'friendship',
    createdAt: 2024-11-26T12:28:30.248Z,
    favoriteId: 1,
    firstSegment: {
      id: 2,
      storyId: 2,
      content: '[Story Text]\n' +
        '\n' +
        'Once upon a time, in a house full of laughter, there lived a boy named Sam. Sam loved adventures as much as he loved his family. Sister Ana, Brother Top, loving Mommy, and his little pet tortoise, Turk.\n' +
        '\n' +
        "One sunny day, Sam's friends visited him - Regal, the brave lion from the nearby zoo, and Batman, his favorite superhero action figure, who magically came to life! \n" +
        '\n' +
        `"Oh, what a wonderful surprise!" cheered Sam. They decided to have a fun day out in the backyard, playing with Brother Top's amazing big kite. \n` +
        '\n' +
        'Unfortunately, a sudden gust of wind caught the kite off guard, to where it flew across the fence and got stuck in a huge tree! "Oh no, our kite!" cried Ana.\n' +
        '\n' +
        `But Turk, the slow but clever tortoise, had an idea. "Regal, use your lion's strength! Batman, you have your grappling hook! And Sam, with your courage, we can retrieve the kite!"\n` +
        '\n' +
        'Regal roared, Batman whooshed, and Sam squealed with all his might! Soon, the kite was safely returned. \n' +
        '\n' +
        '"What a fantastic team we make!" Sam gleamed, hugging his friends. They all cheered. In every adventure, no matter how big or small, they always found a way through teamwork and friendship.\n' +
        '\n' +
        `"Superheroes, lions, tortoises, or humans, we're all friends here!" Sam said, laughing. Because in Sam's house, love, adventure, and friendship always reigned supreme.\n` +
        '\n' +
        "So, at the end of the day, they all sat under the twilight sky, telling stories, eating Mother's delicious cookies, just happy to be together, as the best of friends.",
      imageUrl: 'https://oaidalleapiprodscus.blob.core.windows.net/private/org-8hqUrMQvREaIO7bDZXZNpDR1/user-RcpYfzRbtZ5ra2JTLyVdShGs/img-FCwVHLk2LYjI8M0yqLEI8oNC.png?st=2024-11-26T11%3A28%3A19Z&se=2024-11-26T13%3A28%3A19Z&sp=r&sv=2024-08-04&sr=b&rscd=inline&rsct=image/png&skoid=d505667d-d6c1-4a0a-bac7-5c84a87759f8&sktid=a48cca56-e6da-484e-a814-9c849652bcb3&skt=2024-11-25T18%3A55%3A26Z&ske=2024-11-26T18%3A55%3A26Z&sks=b&skv=2024-08-04&sig=S6RIu2oKaBsmEnAG6OSdWCz/af47FCFHbvMrYfc7TMI%3D',
      audioUrl: '/audio/d98f64d7-bea3-4cfd-b094-102475dc3194.mp3',
      sequence: 1,
      createdAt: 2024-11-26T12:28:30.491Z
    }
  }
]
01:21:52 PM [express] GET /api/favorites 304 in 958ms :: [{"id":4,"childName":"sameer","theme":"adven…
Received story generation request: {
  childName: 'sameer',
  childAge: 4,
  mainCharacter: 'daddy, hanuman, batman, raavan',
  theme: 'fantasy',
  timestamp: '2024-11-26T13:23:00.101Z'
}
Starting story generation process with params: {
  childName: 'sameer',
  childAge: 4,
  mainCharacter: 'daddy, hanuman, batman, raavan',
  theme: 'fantasy'
}
Generating story content with params: {
  childName: 'sameer',
  childAge: 4,
  mainCharacter: 'daddy, hanuman, batman, raavan',
  theme: 'fantasy',
  hasPreviousContent: false
}
Successfully generated story content: {
  textLength: 1218,
  sceneDescriptionLength: 274,
  preview: '[STORY TEXT]\n' +
    '\n' +
    'Once upon a time, in a world of make-believe, a little boy named Sameer was having a f...'
}
Successfully generated story content: { contentLength: 1218, sceneDescriptionLength: 274 }
Generating image with sanitized prompt: {
  originalLength: 274,
  sanitizedLength: 271,
  promptPreview: 'Create a cheerful, child-friendly storybook illustration with the following scene: Sameer and Daddy,...'
}
Generated image URL: https://oaidalleapiprodscus.blob.core.windows.net/private/org-8hqUrMQvREaIO7bDZXZNpDR1/user-RcpYfzRbtZ5ra2JTLyVdShGs/img-cFt4e2yYOWfTDm9JRNJFvCIQ.png?st=2024-11-26T12%3A23%3A43Z&se=2024-11-26T14%3A23%3A43Z&sp=r&sv=2024-08-04&sr=b&rscd=inline&rsct=image/png&skoid=d505667d-d6c1-4a0a-bac7-5c84a87759f8&sktid=a48cca56-e6da-484e-a814-9c849652bcb3&skt=2024-11-25T20%3A34%3A33Z&ske=2024-11-26T20%3A34%3A33Z&sks=b&skv=2024-08-04&sig=lSeC0U4rsppYDPQ8IM5m6appj9CD2LdJyYw5Qo88Ggo%3D
Generating speech for text: [STORY TEXT]

Once upon a time, in a world of make-believe, a little boy named Sameer was having a f...
Successfully saved audio file: /audio/6a954773-c74c-4b62-ae60-5e8a4a9e3391.mp3
Generated audio URL: /audio/6a954773-c74c-4b62-ae60-5e8a4a9e3391.mp3
Successfully created story record: { storyId: 5 }
01:23:53 PM [express] POST /api/stories 200 in 53263ms :: {"id":5,"segments":[{"content":"[STORY TEXT…
01:26:01 PM [express] POST /api/favorites/5 200 in 954ms :: {"id":4,"storyId":5,"createdAt":"2024-11-…