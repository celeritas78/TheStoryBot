 Environment updated. Reloading shell...

> rest-express@1.0.0 dev
> tsx watch --clear-screen=false --exclude vite.config.ts.* server/index.ts

12:14:23 PM [express] serving on port 5000
12:14:28 PM [express] GET /api/favorites 200 in 1017ms :: []

[TypeScript] Found 0 errors. Watching for file changes.
12:14:45 PM [express] GET /api/favorites 200 in 983ms :: []
Received story generation request: {
  childName: 'Sandy',
  childAge: 5,
  mainCharacter: 'mummy',
  theme: 'adventure'
}
Starting story generation process with params: {
  childName: 'Sandy',
  childAge: 5,
  mainCharacter: 'mummy',
  theme: 'adventure'
}
Generating story content with params: {
  childName: 'Sandy',
  childAge: 5,
  mainCharacter: 'mummy',
  theme: 'adventure',
  hasPreviousContent: false
}
Error in story content generation: {
  error: BadRequestError: 400 Invalid parameter: 'response_format' of type 'json_object' is not supported with this model.
      at Function.generate (/home/runner/CustomBedtimeStories/node_modules/openai/src/error.ts:70:14)
      at OpenAI.makeStatusError (/home/runner/CustomBedtimeStories/node_modules/openai/src/core.ts:435:21)
      at OpenAI.makeRequest (/home/runner/CustomBedtimeStories/node_modules/openai/src/core.ts:499:24)
      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
      at generateStoryContent (/home/runner/CustomBedtimeStories/server/services/openai.ts:33:22)
      at <anonymous> (/home/runner/CustomBedtimeStories/server/routes.ts:34:24) {
    status: 400,
    headers: {
      'access-control-expose-headers': 'X-Request-ID',
      'alt-svc': 'h3=":443"; ma=86400',
      'cf-cache-status': 'DYNAMIC',
      'cf-ray': '8e89cd558f2a446e-BOM',
      connection: 'keep-alive',
      'content-length': '217',
      'content-type': 'application/json',
      date: 'Tue, 26 Nov 2024 12:15:07 GMT',
      'openai-organization': 'zime',
      'openai-processing-ms': '17',
      'openai-version': '2020-10-01',
      server: 'cloudflare',
      'set-cookie': '__cf_bm=owXPXFdV0LDv28dS0QpkIhB_g5HOZhDl5dAz8TN_wkg-1732623307-1.0.1.1-dFwhdq6iz1Udp3V3xV67odBqnaPj98UvVGDaWi8qw7RGQhJ.F92PWsB53jqQ_BQGOl7w_C.f9_Mlv0MgAqqgcw; path=/; expires=Tue, 26-Nov-24 12:45:07 GMT; domain=.api.openai.com; HttpOnly; Secure; SameSite=None, _cfuvid=uywJNujy9C2iPlYfgEzsH.agjLjf3.jed.qn6YIwEIg-1732623307413-0.0.1.1-604800000; path=/; domain=.api.openai.com; HttpOnly; Secure; SameSite=None',
      'strict-transport-security': 'max-age=31536000; includeSubDomains; preload',
      'x-content-type-options': 'nosniff',
      'x-ratelimit-limit-requests': '10000',
      'x-ratelimit-limit-tokens': '300000',
      'x-ratelimit-remaining-requests': '9999',
      'x-ratelimit-remaining-tokens': '299895',
      'x-ratelimit-reset-requests': '6ms',
      'x-ratelimit-reset-tokens': '20ms',
      'x-request-id': 'req_46a59e35e956531376a30ce00f823965'
    },
    request_id: 'req_46a59e35e956531376a30ce00f823965',
    error: {
      message: "Invalid parameter: 'response_format' of type 'json_object' is not supported with this model.",
      type: 'invalid_request_error',
      param: 'response_format',
      code: null
    },
    code: null,
    param: 'response_format',
    type: 'invalid_request_error'
  },
  message: "400 Invalid parameter: 'response_format' of type 'json_object' is not supported with this model.",
  stack: "Error: 400 Invalid parameter: 'response_format' of type 'json_object' is not supported with this model.\n" +
    '    at Function.generate (/home/runner/CustomBedtimeStories/node_modules/openai/src/error.ts:70:14)\n' +
    '    at OpenAI.makeStatusError (/home/runner/CustomBedtimeStories/node_modules/openai/src/core.ts:435:21)\n' +
    '    at OpenAI.makeRequest (/home/runner/CustomBedtimeStories/node_modules/openai/src/core.ts:499:24)\n' +
    '    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n' +
    '    at generateStoryContent (/home/runner/CustomBedtimeStories/server/services/openai.ts:33:22)\n' +
    '    at <anonymous> (/home/runner/CustomBedtimeStories/server/routes.ts:34:24)'
}
Story generation failed: Error: Failed to generate story content: 400 Invalid parameter: 'response_format' of type 'json_object' is not supported with this model.
    at generateStoryContent (/home/runner/CustomBedtimeStories/server/services/openai.ts:85:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at <anonymous> (/home/runner/CustomBedtimeStories/server/routes.ts:34:24)
12:15:07 PM [express] POST /api/stories 500 in 328ms :: {"error":"Failed to generate story content","…
